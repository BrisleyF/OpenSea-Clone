<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= articulo.nombre %></title>
    <%- include('../views/partials/head.ejs'); %>
    <link rel="stylesheet" href="/css/detalle.css">
</head>
<body>
    
    <header>
        <%- include('../views/partials/header.ejs'); %>
    </header>

    <% if(!anuncio) { %>
        <main>
            <section class="section-one">
                <div class="one">
                    <div class="contenedor-img">
                        <img src="<%= articulo.imageArticulo %>"" alt="">
                    </div>
                    <div class=" contenedor-descripcion">
                        <div class="contenedor-titulo">
                            <i class="fa-solid fa-list"></i>
                            <h3>Descripción</h3>
                        </div>
                        <div class="descripcion">
                            <p>Por <strong><%= articulo.creador.nombre %></strong></p>
                            <p><%= articulo.descripcion %></p>
                        </div>
                    </div>
                </div>
    
                <div class="two">
                    <div class="contenedor-header">
                        <p> <span><a href="/coleccion/<%= articulo.coleccion._id %>"><%= articulo.coleccion.nombre %></a></span></p>
                        <h1><%= articulo.nombre %></h1>
                        <p>Propiedad de <span><a href="/perfil"><%= articulo.propietario %></a></span></p>
                    </div>
                    <div class="contenedor-precio">
                        <div class="contenedor-reloj">
                            <i class="fa-regular fa-clock"></i>
                            <p>No hay fecha porque el artículo no esta anunciado.</p>
                        </div>
                        <div class="precio">
                            <p>Precio actual</p>
                            <div>
                                <span><strong><%= articulo.precio %> $</strong></span>
                            </div>
                            <div class="botones">
                                <% if(!anuncio) { %>
                                    <% if(articulo.creador._id == userId) { %>
                                        <a href="/vender/<%= articulo._id %>"><button class="venta">Vender</button></a>
                                    <%} else { %>
                                        <a href=""><button class="venta">No tiene anuncio</button></a>
                                    <% } %>
                                <%} else { %>
                                    
                                <% } %>
                            </div>
                        </div>
                    </div>
                    <div class="anuncio">
                        <div class="titulo">
                            <i class="fa-solid fa-tag"></i>
                            <h3>Anuncio</h3>
                        </div>
                        <div class="contenido">
                            <table>
                                <tr>
                                    <th>Precio</th>
                                    <th>Precio en USD</th>
                                    <th>Vencimiento</th>
                                    <th>de</th>
                                    <th></th>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><button><a href="">Comprar</a></button></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="ofertas">
                        <div class="titulo">
                            <i class="fa-solid fa-list"></i>
                            <h3>Ofertas</h3>
                        </div>
                        <div class="contenido">
                            <table>
                                <tr>
                                    <th>Precio</th>
                                    <th>Precio en USD</th>
                                    <th>Diferencia de suelo</th>
                                    <th>Vencimiento</th>
                                    <th>de</th>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
    
            <section class="section-two">
                <div class="actividad">
                    <div class="titulo">
                        <i class="fa-solid fa-arrow-up-right-dots"></i>
                        <h3>Actividad del artículo</h3>
                    </div>
                    <div class="contenido">
                        <table>
                            <tr>
                                <th>Evento</th>
                                <th>Precio</th>
                                <th>De</th>
                                <th>Para</th>
                                <th>Fecha</th>
                            </tr>
                            <tr>
                                <td>Transferir</td>
                                <td>0,1 ETH</td>
                                <td>fulanito 1</td>
                                <td>fulanito 2</td>
                                <td>Hace 3 días</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    
        <%} else { %>
            <main>
                <section class="section-one">
                    <div class="one">
                        <div class="contenedor-img">
                            <img src="<%= anuncio.articulo.imageArticulo %>" alt="">
                    </div>
                    <div class=" contenedor-descripcion">
                            <div class="contenedor-titulo">
                                <i class="fa-solid fa-list"></i>
                                <h3>Descripción</h3>
                            </div>
                            <div class="descripcion">
                                <p>Por <strong><%= articulo.creador.nombre %></strong></p>
                                <p><%= anuncio.articulo.descripcion %></p>
                            </div>
                        </div>
                    </div>
    
                    <div class="two">
                        <div class="contenedor-header">
                            <p> <span><a href="/coleccion/<%= anuncio.coleccion._id %>"><%= anuncio.coleccion.nombre %></a></span></p>
                            <h1><%= anuncio.articulo.nombre %></h1>
                            <p>Propiedad de <span><a href="/perfil"><%= articulo.propietario %></a></span></p>
                        </div>
                        <div class="contenedor-precio">
                            <div class="contenedor-reloj">
                                <i class="fa-regular fa-clock"></i>
                                <p>Fin de la venta el <%= anuncio.vencimiento %></p>
                            </div>
                            <div class="precio">
                                <p>Precio actual</p>
                                <div>
                                    <span><strong><%= anuncio.precioSalida %> $</strong></span>
                                </div>
                                <div class="botones">
                                    <% if(!anuncio) { %>
                                        
                                    <%} else { %>
                                        <% if(articulo.creador._id == userId) { %>
                                            <a href=""><button class="venta">Ya tiene un anuncio</button></a>
                                        <%} else { %>
                                            <a href="/carrito/agregar/<%= anuncio.articulo._id %>"><button class="carrito">Add to cart</button></a>
                                            <% if(anuncio.tipo === 'precio fijo') { %>
                                            
                                            <%} else { %>
                                                <a href="/ofertar/<%= anuncio.articulo._id %>"><button class="oferta">Hacer oferta</button></a>
                                            <% } %>    
                                        <% } %>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                        <div class="anuncio">
                            <div class="titulo">
                                <i class="fa-solid fa-tag"></i>
                                <h3>Anuncio</h3>
                            </div>
                            <div class="contenido">
                                <table>
                                    <tr>
                                        <th>Precio en USD</th>
                                        <th>Vencimiento</th>
                                        <th>de</th>
                                        <th></th>
                                    </tr>
                                    <tr>
                                        <td><%= anuncio.precioSalida %> $</td>
                                        <td><%= anuncio.vencimiento %></td>
                                        <td><%= articulo.propietario %></td>
                                        <td><a href="/carrito/agregar/<%= anuncio.articulo._id %>"><button>Comprar</button></a></td>
                                    </tr>
                                </table>
                            </div>
                        </div>

                        <% if(anuncio.tipo === 'precio fijo') { %>

                        <%} else { %>   
                        <div class="ofertas">
                            <div class="titulo">
                                <i class="fa-solid fa-list"></i>
                                <h3>Ofertas</h3>
                            </div>
                            <div class="contenido">
                                <table>
                                    <tr>
                                        <th>Precio</th>
                                        <th>Diferencia de suelo</th>
                                        <th>Vencimiento</th>
                                        <th>de</th>
                                    </tr>
                                    <% for(const oferta of ofertas) { %>
                                    <tr>
                                        <td><%= oferta.precio %> $</td>
                                        <td><%= oferta.diferencia %> % debajo</td>
                                        <td><%= oferta.vencimiento %></td>
                                        <td><%= oferta.userName %></td>
                                    </tr>
                                    <% } %>
                                </table>
                            </div>
                        </div>
                        <% } %>    
                    </div>
                </section>
    
                <section class="section-two">
                    <div class="actividad">
                        <div class="titulo">
                            <i class="fa-solid fa-arrow-up-right-dots"></i>
                            <h3>Actividad del artículo</h3>
                        </div>
                        <div class="contenido">
                            <table>
                                <tr>
                                    <th>Evento</th>
                                    <th>Precio</th>
                                    <th>De</th>
                                    <th>Para</th>
                                    <th>Fecha</th>
                                </tr>
                                <tr>
                                    <td>Transferir</td>
                                    <td>0,1 ETH</td>
                                    <td>fulanito 1</td>
                                    <td>fulanito 2</td>
                                    <td>Hace 3 días</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </section>
            </main>
            <% } %>

    <footer>
        <%- include('../views/partials/footer.ejs'); %>
    </footer>

    <script src="https://kit.fontawesome.com/dd5e87f640.js" crossorigin="anonymous"></script>
</body>
</html>